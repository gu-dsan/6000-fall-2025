<!DOCTYPE html>
<html lang="en"><head>
<link href="../files/img/dsan6000-logo.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.335">

  <meta name="author" content="Amit Arora, Marck Vaisman, Abhijit Dasgupta">
  <title>DSAN 6000 - Lecture 10</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #cbccc6; background-color: #1f2430; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #cbccc6; } /* Normal */
    code span.al { color: #ff3333; background-color: #332430; font-weight: bold; } /* Alert */
    code span.an { color: #ffe6b3; } /* Annotation */
    code span.at { color: #73d0ff; } /* Attribute */
    code span.bn { color: #ffcc66; } /* BaseN */
    code span.bu { color: #95e6cb; } /* BuiltIn */
    code span.cf { color: #ffa759; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #95e6cb; } /* Char */
    code span.cn { color: #d4bfff; } /* Constant */
    code span.co { color: #5c6773; font-style: italic; } /* Comment */
    code span.cv { color: #d4bfff; } /* CommentVar */
    code span.do { color: #5c6773; } /* Documentation */
    code span.dt { color: #ffa759; } /* DataType */
    code span.dv { color: #ffcc66; } /* DecVal */
    code span.er { color: #ff3333; text-decoration: underline; } /* Error */
    code span.ex { color: #73d0ff; font-weight: bold; } /* Extension */
    code span.fl { color: #ffcc66; } /* Float */
    code span.fu { color: #ffd580; } /* Function */
    code span.im { color: #bae67e; } /* Import */
    code span.in { color: #ffcc66; } /* Information */
    code span.kw { color: #ffa759; font-weight: bold; } /* Keyword */
    code span.op { color: #f29e74; } /* Operator */
    code span.ot { color: #5ccfe6; } /* Other */
    code span.pp { color: #f28779; } /* Preprocessor */
    code span.re { color: #73d0ff; background-color: #2a4254; } /* RegionMarker */
    code span.sc { color: #95e6cb; } /* SpecialChar */
    code span.ss { color: #95e6cb; } /* SpecialString */
    code span.st { color: #bae67e; } /* String */
    code span.va { color: #5ccfe6; } /* Variable */
    code span.vs { color: #bae67e; } /* VerbatimString */
    code span.wa { color: #f28779; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-N2B9K684GE"></script>

  <script type="text/javascript">

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-N2B9K684GE', { 'anonymize_ip': true});
  </script>
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="DSAN 6000 - Lecture 10">
<meta property="og:description" content="Project Q&amp;A and Spark Streaming">
<meta property="og:image" content="https://aa1603.georgetown.edu/dsan6000/files\img\dsan6000-logo.png">
<meta property="og:site-name" content="DSAN 6000">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="600">
<meta property="og:image:width" content="518">
<meta name="twitter:title" content="DSAN 6000 - Lecture 10">
<meta name="twitter:description" content="Project Q&amp;A and Spark Streaming">
<meta name="twitter:image" content="https://aa1603.georgetown.edu/dsan6000/files\img\dsan6000-logo.png">
<meta name="twitter:creator" content="@aarora79">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="600">
<meta name="twitter:image-width" content="518">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Lecture 10</h1>
  <p class="subtitle">Project Q&amp;A and Spark Streaming</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Amit Arora, Marck Vaisman, Abhijit Dasgupta 
</div>
        <p class="quarto-title-affiliation">
            Georgetown University
          </p>
        <p class="quarto-title-affiliation">
            Fall 2024
          </p>
    </div>
</div>

</section>
<section class="slide level2">

<div class="cell">

</div>
<div class="column" style="width:47%;">
<h3 id="looking-back">Looking Back</h3>
<ul>
<li>Intro to Hadoop and MapReduce</li>
<li>Hadoop Streaming</li>
<li>Dask</li>
<li>Spark RDDs, DataFrames, SparkSQL, SparkML, SparkNLP</li>
</ul>
<h3 id="future">Future</h3>
<ul>
<li>Docker containers / Lambda functions</li>
<li>Data engineering</li>
</ul>
</div>
<div class="column" style="width:47%;">
<h3 id="today">Today</h3>
<ul>
<li><p>Project Discussion</p></li>
<li><p>Spark Streaming</p></li>
<li><p>Lab:</p>
<ul>
<li>Spark Streaming</li>
</ul></li>
</ul>
</div>
</section>
<section>
<section id="essential-hardwarehadoop-topics" class="title-slide slide level1 section center">
<h1>Essential Hardware/Hadoop Topics</h1>

</section>
<section id="aws-academy" class="slide level2">
<h2>AWS Academy</h2>
<ul>
<li><p>Credit limit - $100</p></li>
<li><p>Course numbers:</p>
<ul>
<li>Course #1 - 24178</li>
<li>Course #2 - 27354</li>
<li>Course #3 - 22802</li>
<li>Course #4 - 26418</li>
</ul></li>
</ul>
<p>STAY WITH COURSE 24178 UNLESS YOU HAVE RUN OUT OF CREDITS OR &gt;$90 USED!</p>
<p>Note that you will have to repeat several setup steps:</p>
<ul>
<li>security group</li>
<li>EC2 keypair uploading (the AWS part only)</li>
<li>sagemaker setup</li>
<li>any S3 uploading or copying as well as bucket creation as necessary</li>
<li>EMR configuration</li>
</ul>
</section>
<section id="connected-and-extensible" class="slide level2">
<h2>Connected and extensible</h2>
<div class="imgcenter">
<p><img src="img/spark-connectors.png" width="600"></p>
</div>
</section>
<section id="caching-and-persistence" class="slide level2">
<h2>Caching and Persistence</h2>
<p>By default, RDDs are recomputed every time you run an action on them. This can be expensive (in time) if you need to use a dataset more than once.</p>
<p><strong>Spark allows you to control what is cached in memory.</strong></p>
<p>To tell spark to cache an object in memory, use <code>persist()</code> or <code>cache()</code>:</p>
<ul>
<li><code>cache():</code> is a shortcut for using default storage level, which is memory only</li>
<li><code>persist():</code> can be customized to other ways to persist data (including both memory and/or disk)</li>
</ul>
<div class="cell" data-python.reticulate="false">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># caches error RDD in memory, but only after an action is run</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>errors <span class="op">=</span> logs.<span class="bu">filter</span>(<span class="kw">lambda</span> x: <span class="st">"error"</span> <span class="kw">in</span> x <span class="kw">and</span> <span class="st">"2019-12"</span> <span class="kw">in</span> x).cache()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="collect-caution" class="slide level2">
<h2><code>collect</code> <strong>CAUTION</strong></h2>
<div class="imgcenter">
<p><img src="img/collect-warning.png"></p>
</div>
</section>
<section id="spark-ui---executors" class="slide level2">
<h2>Spark UI - Executors</h2>
<div class="imgcenter">
<p><img src="img/spark-ui-executors.png" width="700"></p>
</div>
</section>
<section id="udf-speed-comparison" class="slide level2">
<h2>UDF Speed Comparison</h2>
<div class="column" style="width:57%;">
<p><img src="img/spark-udf-speed.png" width="700"></p>
</div>
<div class="column" style="width:41%;">
<p>Costs:</p>
<ul>
<li>Serialization/deserialization (think pickle files)</li>
<li>Data movement between JVM and Python</li>
<li>Less Spark optimization possible</li>
</ul>
<p>Other ways to make your Spark jobs faster <a href="https://sparkbyexamples.com/spark/spark-performance-tuning/">source</a>:</p>
<ul>
<li>Cache/persist your data into memory</li>
<li>Using Spark DataFrames over Spark RDDs</li>
<li>Using Spark SQL functions before jumping into UDFs</li>
<li>Save to serialized data formats like Parquet</li>
</ul>
</div>
</section>
<section id="pipelines" class="slide level2">
<h2>Pipelines</h2>
<div class="imgcenter">
<p><img src="img/pipeline-oriented.png" width="800"></p>
</div>
</section>
<section id="most-popular-aiml-packages" class="slide level2">
<h2>Most Popular AI/ML Packages</h2>
<div class="imgcenter">
<p><img src="img/spark-nlp-popular-packages.png" width="900"></p>
</div>
</section>
<section id="spark-nlp-terminology" class="slide level2">
<h2>Spark NLP Terminology</h2>
<h4 id="annotators">Annotators</h4>
<ul>
<li>Like the ML tools we used in Spark</li>
<li>Always need input and output columns</li>
<li>Two flavors:
<ul>
<li>Approach - like ML estimators that need a <code>fit()</code> method to make an Annotator Model or Transformer</li>
<li>Model - like ML transformers and uses <code>transform()</code> method only</li>
</ul></li>
</ul>
<h4 id="annotator-models">Annotator Models</h4>
<ul>
<li>Pretrained public versions of models available through <code>.pretained()</code> method</li>
</ul>
</section></section>
<section>
<section id="project-discussion" class="title-slide slide level1 section center">
<h1>Project Discussion</h1>

</section>
<section id="reddit-data" class="slide level2">
<h2>Reddit Data!</h2>
<div class="column" style="width:49%;">
<p><img src="img/reddit-paper-fig1.png"></p>
</div>
<div class="column" style="width:49%;">
<p><img src="img/reddit-paper-fig4.png"></p>
</div>
</section>
<section id="assignment-details" class="slide level2">
<h2>Assignment Details</h2>
<p>Reviewing <code>Project Milestone 1: EDA</code></p>
</section>
<section id="open-qa" class="slide level2">
<h2>Open Q&amp;A</h2>
<p>Questions about the project requirements?</p>
<p>Questions about using Databricks?</p>
</section></section>
<section id="start-your-aws-spark-cluster---1-master-1-or-2-core" class="title-slide slide level1 section center">
<h1>Start your AWS Spark Cluster - 1 Master, 1 or 2 Core</h1>

</section>

<section>
<section id="spark-streaming" class="title-slide slide level1 section center">
<h1>Spark Streaming</h1>

</section>
<section id="up-to-now-weve-worked-with-batch-data" class="slide level2">
<h2>Up to now, we’ve worked with batch data</h2>
<p>Processing large, already collected, <em>batches</em> of data.</p>
<div class="imgcenter">
<p><img src="img/s1.jpg" width="800"></p>
</div>
</section>
<section id="batch-examples" class="slide level2">
<h2>Batch examples</h2>
<p>Examples of batch data analysis?</p>
<div class="fragment fade-up">
<ul>
<li><p>Analysis of terabytes of logs collected over a long period of time</p></li>
<li><p>Analysis of code bases on GitHub or other large repositories of textual information such as Wikipedia</p></li>
<li><p>Nightly analysis on large data sets collected over a 24 hour period</p></li>
</ul>
</div>
</section>
<section id="streaming-examples" class="slide level2">
<h2>Streaming Examples</h2>
<p>Examples of streaming data analysis?</p>
<div class="fragment fade-up">
<ul>
<li><p>Credit card fraud detection</p></li>
<li><p>Sensor data processing</p></li>
<li><p>Online advertising based on user actions</p></li>
<li><p>Social media notifications</p></li>
</ul>
</div>
<div class="fragment fade-up">
<p>International Data Coporation (IDC) <a href="https://www.businesswire.com/news/home/20190618005012/en/The-Growth-in-Connected-IoT-Devices-is-Expected-to-Generate-79.4ZB-of-Data-in-2025-According-to-a-New-IDC-Forecast">forecasts</a> that by 2025 IoT devices will generate 79.4 zettabytes of data.</p>
</div>
</section>
<section id="how-do-we-work-with-streams" class="slide level2">
<h2>How do we work with streams?</h2>
<p>Processing every value coming from a <em>stream</em> of data. That is, data values that are <strong>constantly</strong> arriving</p>
<div class="imgcenter">
<p><img src="img/s2.jpg" width="800"></p>
</div>
</section>
<section id="spark-solved-this-problem-by-creating-dstreams-using-microbatching" class="slide level2">
<h2>Spark solved this problem by creating <code>DStreams</code> using <em>microbatching</em></h2>
<p><code>DStreams</code> are represented as a <strong>sequence</strong> of RDDs.</p>
<div class="imgcenter">
<p><img src="img/s4.jpg" width="800"></p>
</div>
<p>A <code>StreamingContext</code> object can be created from an existing <code>SparkContext</code> object.</p>
<div class="cell" data-python.reticulate="false">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>sc <span class="op">=</span> ...</span>
<span id="cb2-2"><a href="#cb2-2"></a>ssc <span class="op">=</span> StreamingContext(sc, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="important-points-about-streamingcontext" class="slide level2">
<h2>Important points about <code>StreamingContext</code></h2>
<ol type="1">
<li><p>Once the context has been started, no new streaming computations can be setup or added</p></li>
<li><p>Once a context has been stopped, it cannot be restarted</p></li>
<li><p>Only <strong>one</strong> <code>StreamingContext</code> can active with a Spark session at the same time</p></li>
<li><p><code>stop()</code> on the <code>StreamingContext</code> also stops the the <code>SparkContext</code></p></li>
<li><p>Multiple <code>StreamingContext</code> can be created as long as the previous one is stopped</p></li>
</ol>
</section>
<section id="dstreams-had-some-issues" class="slide level2">
<h2><code>DStreams</code> had some issues</h2>
<ul>
<li><p><strong>Lack of a single API for batch and stream processing:</strong> Even though DStreams and RDDs have consistent APIs (i.e., same operations and same semantics), developers still had to <em>explicitly rewrite their code to use different classes</em> when converting their batch jobs to streaming jobs.</p></li>
<li><p><strong>Lack of separation between logical and physical plans:</strong> Spark Streaming executes the DStream operations in the same sequence in which they were specified by the developer. Since developers effectively specify the exact physical plan, there is no scope for automatic optimizations, and developers have to hand-optimize their code to get the best performance.</p></li>
<li><p><strong>Lack of native support for event-time windows:</strong> DStreams define window operations based only on the time when each record is received by Spark Streaming (known as processing time). However, many use cases need to calculate windowed aggregates based on the time when the records were generated (known as event time) instead of when they were received or processed. The lack of native support of event-time windows made it hard for developers to build such pipelines with Spark Streaming.</p></li>
</ul>
</section></section>
<section>
<section id="structured-streaming-dataframe-based" class="title-slide slide level1 section center">
<h1>Structured Streaming (DataFrame) based</h1>

</section>
<section id="what-is-structured-streaming" class="slide level2">
<h2>What is Structured Streaming?</h2>
<h3 id="a-single-unified-programming-model-and-interface-for-batch-and-stream-processing">A single, unified programming model and interface for batch and stream processing</h3>
<p>This unified model offers a simple API interface for both batch and streaming workloads. You can use familiar SQL or batch-like DataFrame queries on your stream as you would on a batch, leaving dealing with the underlying complexities of fault tolerance, optimizations, and tardy data to the engine.</p>
<h3 id="a-broader-definition-of-stream-processing">A broader definition of stream processing</h3>
<p>Big data processing applications have grown complex enough that the line between real-time processing and batch processing has blurred significantly. The aim with Structured Streaming was to broaden its applicability from traditional stream processing to a larger class of applications; any application that periodically (e.g., every few hours) to continuously (like traditional streaming applications) processes data should be expressible using Structured Streaming.</p>
</section>
<section id="the-programming-model-of-structured-streaming" class="slide level2">
<h2>The Programming Model of Structured Streaming</h2>
<div class="imgcenter">
<p><img src="img/lesp_0803.png" width="800"></p>
</div>
</section>
<section id="the-programming-model-of-structured-streaming-1" class="slide level2">
<h2>The Programming Model of Structured Streaming</h2>
<div class="column" style="width:49%;">
<ul>
<li>Every new record received in the data stream is like a new row being appended to the unbounded input table.</li>
<li>Structured Streaming will automatically convert this batch-like query to a streaming execution plan. This is called incrementalization</li>
<li>Structured Streaming figures out what state needs to be maintained to update the result each time a record arrive</li>
<li>Finally, developers specify triggering policies to control when to update the results. Each time a trigger fires, Structured Streaming checks for new data (i.e., a new row in the input table) and incrementally updates the result.</li>
</ul>
</div>
<div class="column" style="width:49%;">
<p><img src="img/lesp_0804.png"></p>
</div>
</section>
<section id="specifying-output-mode" class="slide level2">
<h2>Specifying output mode</h2>
<h3 id="append-mode">Append mode</h3>
<p>Only the new rows appended to the result table since the last trigger will be written to the external storage. This is applicable only in queries where existing rows in the result table cannot change (e.g., a map on an input stream).</p>
<h3 id="update-mode">Update mode</h3>
<p>Only the rows that were updated in the result table since the last trigger will be changed in the external storage. This mode works for output sinks that can be updated in place, such as a MySQL table.</p>
<h3 id="complete-mode">Complete mode</h3>
<p>The entire updated result table will be written to external storage.</p>
</section>
<section id="the-5-fundamentals-steps-of-a-structured-streaming-query" class="slide level2">
<h2>The 5 Fundamentals steps of a Structured Streaming Query</h2>
<ol type="1">
<li><p>Define input sources</p></li>
<li><p>Transform data</p></li>
<li><p>Define output sink and output mode</p></li>
<li><p>Specify processing details</p></li>
<li><p>Start the query</p></li>
</ol>
</section>
<section id="define-input-sources" class="slide level2">
<h2>1. Define input sources</h2>
<div class="column" style="width:49%;">
<div class="cell" data-python.reticulate="false">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a> spark <span class="op">=</span> SparkSession...</span>
<span id="cb3-2"><a href="#cb3-2"></a>    lines <span class="op">=</span> (spark</span>
<span id="cb3-3"><a href="#cb3-3"></a>      .readStream.<span class="bu">format</span>(<span class="st">"socket"</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>      .option(<span class="st">"host"</span>, <span class="st">"localhost"</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>      .option(<span class="st">"port"</span>, <span class="dv">9999</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>      .load())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="column" style="width:49%;">
<ul>
<li>This code generates the lines <code>DataFrame</code> as an unbounded table of newline-separated text data read from <code>localhost:9999</code>. Note that, similar to batch sources with spark.read, this does not immediately start reading the streaming data; it only sets up the configurations necessary for reading the data once the streaming query is explicitly started.</li>
<li>Besides sockets, Apache Spark natively supports reading data streams from Apache Kafka and various file-based formats (Parquet, ORC, JSON, etc.). A streaming query can define multiple input sources, both streaming and batch, which can be combined using DataFrame operations like unions and joins.</li>
</ul>
</div>
</section>
<section id="transform-data" class="slide level2">
<h2>2. Transform data</h2>
<div class="cell" data-python.reticulate="false">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">from</span> pyspark.sql.functions <span class="im">import</span> <span class="op">*</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>words <span class="op">=</span> lines.select(split(col(<span class="st">"value"</span>), <span class="st">"</span><span class="ch">\\</span><span class="st">s"</span>).alias(<span class="st">"word"</span>)) </span>
<span id="cb4-3"><a href="#cb4-3"></a>counts <span class="op">=</span> words.groupBy(<span class="st">"word"</span>).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Now we can apply the usual DataFrame operations</li>
<li>Note that these operations to transform the lines streaming DataFrame would work in the exact same way if lines were a batch DataFrame.</li>
</ul>
</section>
<section id="define-output-sink-and-output-mode" class="slide level2">
<h2>3. Define output sink and output mode</h2>
<div class="cell" data-python.reticulate="false">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>writer <span class="op">=</span> counts.writeStream.<span class="bu">format</span>(<span class="st">"console"</span>).outputMode(<span class="st">"complete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="specify-processing-details" class="slide level2">
<h2>4. Specify Processing details</h2>
<div class="column" style="width:44%;">
<div class="cell" data-python.reticulate="false">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>checkpointDir <span class="op">=</span> <span class="st">"..."</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>    writer2 <span class="op">=</span> (writer</span>
<span id="cb6-3"><a href="#cb6-3"></a>      .trigger(processingTime<span class="op">=</span><span class="st">"1 second"</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>      .option(<span class="st">"checkpointLocation"</span>, checkpointDir))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="column" style="width:54%;">
<p><strong>Triggering details</strong></p>
<ul>
<li><strong>Default:</strong> When the trigger is not explicitly specified, then by default, the streaming query executes data in micro-batches where the next micro-batch is triggered as soon as the previous micro-batch has completed.</li>
<li><strong>Processing time with trigger interval:</strong> You can explicitly specify the Processing Time trigger with an interval, and the query will trigger micro-batches at that fixed interval.</li>
<li><strong>Once:</strong> In this mode, the streaming query will execute exactly one micro-batch. It processes new data available in a single batch and then stops itself. This is useful when you want to control the triggering and processing from an external scheduler that will start the query on a schedule (e.g., to control cost by only executing a query once per day).</li>
<li><strong>Continuous: </strong> experimental as of Spark 3.0</li>
</ul>
</div>
</section>
<section id="start-the-query" class="slide level2">
<h2>5. Start the query</h2>
<div class="cell" data-python.reticulate="false">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>streamingQuery <span class="op">=</span> writer2.start()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="spark-streaming-under-the-hood" class="slide level2">
<h2>Spark Streaming under the hood</h2>
<div class="column" style="width:49%;">
<ol type="1">
<li>Spark SQL analyzes and optimizes this logical plan to ensure that it can be executed incrementally and efficiently on streaming data.</li>
<li>Spark SQL starts a background thread that continuously executes a loop</li>
<li>This loop continues until the query is terminated</li>
</ol>
</div>
<div class="column" style="width:49%;">
<p><img src="img/lesp_0805.png"></p>
</div>
</section>
<section id="spark-streaming-under-the-hood-1" class="slide level2">
<h2>Spark Streaming under the hood</h2>
<div class="column" style="width:55%;">
<p><strong>The loop</strong></p>
<ol type="a">
<li><p>Based on the configured trigger interval, the thread checks the streaming sources for the availability of new data.</p></li>
<li><p>If available, the new data is executed by running a micro-batch. From the optimized logical plan, an optimized Spark execution plan is generated that reads the new data from the source, incrementally computes the updated result, and writes the output to the sink according to the configured output mode.</p></li>
<li><p>For every micro-batch, the exact range of data processed (e.g., the set of files or the range of Apache Kafka offsets) and any associated state are saved in the configured checkpoint location so that the query can deterministically reproc‐ ess the exact range if needed.</p></li>
</ol>
</div>
<div class="column" style="width:43%;">
<p><img src="img/lesp_0805.png"></p>
</div>
</section>
<section id="spark-streaming-under-the-hood-2" class="slide level2">
<h2>Spark Streaming under the hood</h2>
<div class="column" style="width:49%;">
<p><strong>The loop continues until the query is terminated which can be for one of the following reasons:</strong></p>
<ol type="a">
<li><p>A failure has occurred in the query (either a processing error or a failure in the cluster).</p></li>
<li><p>The query is explicitly stopped using streamingQuery.stop().</p></li>
<li><p>If the trigger is set to <code>Once</code>, then the query will stop on its own after executing a single micro-batch containing all the available data.</p></li>
</ol>
</div>
<div class="column" style="width:49%;">
<p><img src="img/lesp_0805.png"></p>
</div>
</section>
<section id="data-transformations" class="slide level2">
<h2>Data Transformations</h2>
<p>Each execution is considered as a <em>micro-batch</em>. DataFrame operations can be broadly classified into <em>stateless</em> and <em>stateful</em> operations based on whether executing the operation incrementally requires maintaining a state.</p>
</section>
<section id="stateless-transformations" class="slide level2">
<h2>Stateless Transformations</h2>
<p>All projection operations (e.g., <code>select()</code>, <code>explode()</code>, <code>map()</code>, <code>flatMap()</code>) and selection operations (e.g., <code>filter()</code>, <code>where()</code>) process each input record individually without needing any information from previous rows. This lack of dependence on prior input data makes them stateless operations.</p>
<p>A streaming query having only stateless operations supports the append and update output modes, but not complete mode. This makes sense: since any processed output row of such a query cannot be modified by any future data, it can be written out to all streaming sinks in append mode (including append-only ones, like files of any format). On the other hand, such queries naturally do not combine information across input records, and therefore may not reduce the volume of the data in the result. Complete mode is not supported because storing the ever-growing result data is usually costly. This is in sharp contrast with stateful transformations, as we will discuss next.</p>
</section>
<section id="stateful-transformations" class="slide level2">
<h2>Stateful Transformations</h2>
<p>The simplest example of a stateful transformation is <code>DataFrame.groupBy().count()</code>, which generates a running count of the number of records received since the beginning of the query. In every micro-batch, the incremental plan adds the count of new records to the previous count generated by the previous micro-batch. This partial count communicated between plans is the state. This state is maintained in the memory of the Spark executors and is checkpointed to the configured location in order to tolerate failures. While Spark SQL automatically manages the life cycle of this state to ensure correct results, you typically have to tweak a few knobs to control the resource usage for maintaining state. In this section, we are going to explore how different stateful operators manage their state under the hood.</p>
</section>
<section id="stateful-streaming-aggregations" class="slide level2">
<h2>Stateful Streaming Aggregations</h2>
<p>Structured Streaming can incrementally execute most DataFrame aggregation operations. You can aggregate data by keys (e.g., streaming word count) and/or by time (e.g., count records received every hour).</p>
<ul>
<li><p>Aggregations Not Based on Time</p></li>
<li><p>Aggregations with Event-Time Windows</p></li>
</ul>
</section>
<section id="mapping-of-event-time-to-tumbling-windows" class="slide level2">
<h2>Mapping of event time to tumbling windows</h2>
<div class="imgcenter">
<p><img src="img/lesp_0807.png" width="800"></p>
</div>
</section>
<section id="mapping-of-event-time-to-multiple-overlapping-windows" class="slide level2">
<h2>Mapping of event time to multiple overlapping windows</h2>
<div class="imgcenter">
<p><img src="img/lesp_0808.png" width="800"></p>
</div>
</section>
<section id="updated-counts-in-the-result-table-after-each-five-minute-trigger" class="slide level2">
<h2>Updated counts in the result table after each five-minute trigger</h2>
<div class="imgcenter">
<p><img src="img/lesp_0809.png" width="800"></p>
</div>
</section>
<section id="using-watermarks" class="slide level2">
<h2>Using watermarks</h2>
<p>A watermark is defined as a moving threshold in event time that trails behind the maximum event time seen by the query in the processed data. The trailing gap, known as the watermark delay, defines how long the engine will wait for late data to arrive.</p>
<div class="imgcenter">
<p><img src="img/lesp_0810.png" width="700"></p>
</div>
</section>
<section id="aws-kinesis" class="slide level2">
<h2>AWS Kinesis</h2>
<div class="imgcenter">
<p><img src="img/kinesis.png" width="400"></p>
</div>
<ul>
<li>Similar to Apache Kafka</li>
<li>Abstracts away much of the configuration details</li>
<li>Costs based on usage</li>
</ul>
<p>Read more comparisons <a href="https://hevodata.com/learn/amazon-kinesis-vs-kafka/">here</a>.</p>
</section>
<section id="spark-sql-connector-for-aws-kinesis" class="slide level2">
<h2>Spark SQL Connector for AWS Kinesis</h2>
<p>Connector to make Kinesis work with Spark Structured Streaming</p>
<p>https://github.com/qubole/kinesis-sql</p>
</section></section>
<section id="lab" class="title-slide slide level1 section center">
<h1>Lab</h1>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'print',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>